<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ topic }} {% if subtopic %}- {{ subtopic }}{% endif %} Quiz</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
        background: linear-gradient(to right, #6a11cb, #2575fc);
        min-height: 100vh;
        color: white;
        font-family: Arial, sans-serif;
        padding: 30px 0;
    }

    .container {
        max-width: 900px;
    }

    .header {
        position: relative;
        margin-bottom: 40px;
    }

    .header h2 {
        font-weight: bold;
        text-align: center;
        color: white;
    }

    .btn-back {
        position: absolute;
        top: 0;
        left: 0;
        background-color: #35b2dcff;
        border-color: #3554dcff;
        font-weight: bold;
        color: white;
    }

    .btn-back:hover {
        background-color: #23a7c8ff;
        border-color: #232ec8ff;
        color: white;
    }

    .info-box {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 30px;
        text-align: center;
    }

    .question-card {
        background: white;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .question-number {
        background: linear-gradient(to right, #6a11cb, #2575fc);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 15px;
        font-size: 1.1rem;
    }

    .question-text {
        color: #333;
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 20px;
    }

    .form-check {
        background: #f8f9fa;
        padding: 12px 15px;
        border-radius: 10px;
        margin-bottom: 10px;
        border: 2px solid transparent;
        transition: all 0.2s;
    }

    .form-check:hover {
        background: #e9ecef;
        border-color: #2575fc;
    }

    .form-check-input {
        width: 20px;
        height: 20px;
    }

    .form-check-label {
        color: #555;
        cursor: pointer;
        margin-left: 10px;
        font-size: 1rem;
    }

    .btn-submit {
        background-color: #356fdcff;
        color: white;
        border: none;
        padding: 15px 50px;
        font-size: 1.1rem;
        font-weight: bold;
        border-radius: 10px;
        transition: all 0.3s;
    }

    .btn-submit:hover {
        background-color: #8335dcff;
        transform: translateY(-2px);
    }

    .result-card {
        background: white;
        border-radius: 20px;
        padding: 50px;
        text-align: center;
        box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        color: #333;
    }

    .score-display {
        font-size: 4rem;
        font-weight: 900;
        background: linear-gradient(to right, #6a11cb, #2575fc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin: 20px 0;
    }

    .percentage {
        font-size: 1.5rem;
        color: #666;
        margin-bottom: 30px;
    }

    .result-message {
        font-size: 1.3rem;
        color: #2575fc;
        font-weight: bold;
        margin-bottom: 30px;
    }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <a href="{{ url_for('dashboard') }}" class="btn btn-back">‚Üê Back</a>
    <h2>üéØ {{ topic }} {% if subtopic %}- {{ subtopic }}{% endif %} Quiz</h2>
  </div>

  {% if not submitted %}
  <div class="info-box">
    <h5>üìù Total Questions: {{ questions|length }}</h5>
    <p>Take your time and answer carefully. Good luck!</p>
  </div>

  <form method="POST" id="quizForm">
    {% for q in questions %}
    <div class="question-card">
      <div class="d-flex align-items-start">
        <span class="question-number">{{ loop.index }}</span>
        <div class="flex-grow-1">
          <div class="question-text">{{ q.q }}</div>
          {% set outer_loop = loop %}
          {% for opt in q.options %}
          <div class="form-check">
            <input class="form-check-input" 
                   type="radio" 
                   name="q{{ outer_loop.index0 }}" 
                   id="q{{ outer_loop.index0 }}_opt{{ loop.index }}" 
                   value="{{ opt }}" 
                   required>
            <label class="form-check-label" for="q{{ outer_loop.index0 }}_opt{{ loop.index }}">
              {{ opt }}
            </label>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
    {% endfor %}
    
    <div class="text-center mt-4">
      <button type="submit" class="btn btn-submit">Submit Quiz</button>
    </div>
  </form>
  
  {% else %}
  <div class="result-card">
    {% set percent = (score / questions|length * 100)|round(1) %}
    <div class="result-message">
      {% if percent >= 80 %}
        üèÜ Outstanding Performance!
      {% elif percent >= 60 %}
        ‚≠ê Great Job!
      {% else %}
        üìö Keep Working Hard!
      {% endif %}
    </div>
    <div class="score-display">{{ score }}/{{ questions|length }}</div>
    <div class="percentage">{{ percent }}%</div>
    <p style="color: #666; font-size: 1.1rem; margin-bottom: 20px;">
      You answered {{ score }} questions correctly out of {{ questions|length }} total questions.
    </p>

    {% if suggestion %}
    <div style="background: #fff3cd; border-left: 5px solid #ffc107; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: left;">
      <h5 style="color: #856404; margin: 0 0 10px 0;">üìä Performance Feedback</h5>
      <p style="color: #856404; margin: 0; font-size: 1rem;">{{ suggestion }}</p>
    </div>
    {% endif %}

    <div style="margin-top: 30px;">
      <a href="{{ url_for('suggestions') }}" class="btn btn-submit" style="margin-right: 10px;">View All Suggestions</a>
      <a href="{{ url_for('dashboard') }}" class="btn btn-submit" style="background-color: #6c757d;">Back to Dashboard</a>
    </div>
  </div>
  {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>